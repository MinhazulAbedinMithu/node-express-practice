<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<script src="https://cdn.tailwindcss.com"></script>
		<title>Practice HTTP Methods</title>
	</head>
	<body class="bg-gray-400">
		<div
			class="container mx-auto my-10 py-10 px-5 h-min-[90vh] bg-gradient-to-r from-cyan-800 via-rose-900 to-emerald-900 rounded-md text-white"
		>
			<h2 class="text-center text-4xl font-bold">HTTP Method Practice</h2>

			<form
				action="/api/people"
				method="POST"
				class="submit-form flex flex-col items-center justify-center gap-5 py-20"
			>
				<div class="flex flex-col">
					<input
						type="text"
						name="name"
						id="name"
						placeholder="Enter your name"
						autocomplete="false"
						class="input-name px-5 py-2 text-xl rounded-xl text-black font-bold"
					/>
					<span class="form-alert pl-5"></span>
				</div>
				<button
					class="submit-btn px-5 py-2 text-2xl font-bold rounded-xl bg-yellow-400 text-violet-800"
				>
					Submit
				</button>
			</form>
			<div
				class="py-5 people-container flex items-center justify-center gap-5 text-2xl text-white"
			></div>
		</div>
	</body>
	<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
	<script>
		//declaration::
		const peopleContainer = document.querySelector(".people-container");
		const inputName = document.querySelector(".input-name");
		const submitBtn = document.querySelector(".submit-btn");
		const formAlert = document.querySelector(".form-alert");

		//get people implement:
		const fetchPeople = async () => {
			try {
				const { data } = await axios.get("/api/people");
				const peopleItem = data.data.map((people) => {
					return `<h4>${people.name}</h4>`;
				});
				peopleContainer.innerHTML = peopleItem.join(" ");
			} catch (err) {
				peopleContainer.innerHTML = `<h4>Can't fetch Peoples</h4>`;
			}
		};
		fetchPeople();

		//Post People:::
		submitBtn.addEventListener("click", async (e) => {
			e.preventDefault();
			const inputNameValue = inputName.value;
			console.log(inputNameValue);
			try {
				const { data } = await axios.post("/api/people", {
					name: inputNameValue,
				});
				const newPeople = document.createElement("h4");
				newPeople.textContent = data.person;

				peopleContainer.appendChild(newPeople);
			} catch (err) {
				formAlert.innerText = err.response.data.msg;
			}
		});
	</script>
</html>
